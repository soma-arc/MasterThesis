%#BIBTEX biber --bblencoding=utf8 -u -U --output_safechars main
%#!uplatex main.tex

\section{Preparation}

In this section, we introduce prerequisites to understand
Iterated Inversion System (IIS) and basic usage of IIS.

\subsection{Kleinian Groups}

Kleinian groups is discrete sub-group of the M\"obius transformation
groups. Briefly, group of the transformations which meet some conditions.

The word \textit{group} or \textit{transformation group} means a set of
transformations. 
We call initial elements of the group \textit{generators}.
For example, we assume there are two transformations $f(z)$ and $g(z)$.
We write transformations lower case, for example we write $a$ as $f(z)$
and $b$ as $g(z)$. Also, we use capitalized letters for inverse
transformations. 
We write compositions of transformations as line up letters.
For instance, $f(z) \circ g(z) \circ f(z)^{-1}$ is $abA$.
We call the letters \textit{word}.

In this paper, we follow the notations of Indra's Pearls
\cite{MumfordSeriesWright200204}, for more details, read the book.

\subsection{M\"obius Transformations and Inversions}

M\"obius transformations are defined in the extended complex plane,
$\hat{\mathbb{C}} = \mathbb{C} \cup \{\infty\}$ and expressed as linear
fractional transformation
$f(z)=\frac{az + b}{cz + d}$, where $a,~b,~c,~d,~z \in \hat{\mathbb{C}}$.
However, it is also known that we can construct them out of a finite
composition of inversions. For more details, see the chapter 1 of \cite{marden_2016}.

M\"obius transformations are classified into three types as \textit{loxodromic},
\textit{parabolic}, or \textit{elliptic}.
Loxodromic transformations have two fixed points and are conjugate to
scaling by complex numbers except for scaling by unit complex numbers.
Those whose multiplier is a positive real number
are also called hyperbolic transformations.Parabolic transformations
have one fixed point and are conjugate to parallel translations.
Elliptic transformations have two fixed points and are conjugate to rotations.

An inversion in a circle
is defined as $f(z) = \frac{r^2}{~\overline{z - c}~} + c$, where $c$ and
$r$ are center and radius of the circle.
Note that an inversion in a circle with infinite radius is the same as
a reflection over a line.
Also, sphere inversion can be derived from a similar equation, and an inversion
in a sphere with infinite radius is the same as
a reflection through a plane.

\subsection{Basic Methods for Visualization}

\begin{figure}[htbp]
 \begin{minipage}[t]{0.333\hsize}
  \center
  \includegraphics[height=1.35in, keepaspectratio]{img/cayleyGraph.png}
  \caption{\textit{Cayley Graph}}
  \label{fig:cayleyGraph}
  \hspace*{\fill}
 \end{minipage}
 \begin{minipage}[t]{0.333\hsize}
  \center
  \includegraphics[height=1.35in, keepaspectratio]{img/preparation/basic/catOrbit.png}
  \caption{\textit{Orbit of the image}}
  \label{fig:orbitCat}
  \hspace*{\fill}
 \end{minipage}
 \begin{minipage}[t]{0.333\hsize}
  \center
  \includegraphics[height=1.35in, keepaspectratio]{img/preparation/limitSet/limit.png}
  \caption{\textit{Limit set of the Kleinian group}}
  \label{fig:limit}
  \hspace*{\fill}
 \end{minipage}
\end{figure}

\noindent In this section, we introduce basic methods for visualizing Kleinian groups.
We consider \textit{cayley graph} of the Kleinian groups to enumerate elements
of the groups.
Figure \ref{fig:cayleyGraph} shows Cayley graph of the group generated
by two transformations.
The nodes of the graph represent compositions of elements of the group.
According to the way of traversing, 
there are two types of visualization of transformation groups.

Firstly, we can draw orbit of the group by traversing the cayley graph with
breadth first search.
See Figure \ref{fig:orbitCat}.
The cat in the center transformed by found words.
Moreover, we can consider tiling of the first tile.
If the group meet some conditions, we can tile them without gaps and
self intersections.
The circles and cats converges, and
we call the limit part the \textit{limit set} of the group.

Secondly, we can only draw the limit set of the group by traversing the
cayley graph with depth first search.
The limit set located at the end of Cayley graph. Thus, we use fixed
point of the transformation.
we apply obtained word to the fixed points.
For more details, read Indra's Pearls.
Figure \ref{fig:limit} shows one of the limit set of the Kleinian group.

However, there are some faults in these methods.
For example, if we increase the number of generators,
It takes too much time to traverse the graph because of
combinatorial explosion.
Also, We have to traverse all of the graph
even though we don't need images outside of the screen.
This is the reason why we need other methods to visualize Kleinian
groups.

\subsection{Iterated Inversion System (IIS)}

\begin{figure}[htbp]
 \begin{minipage}[t]{0.16\hsize}
  \center
  \includegraphics[width=1in, height=1in, keepaspectratio]{./img/preparation/orbit/level0c.pdf}
  \subcaption{}
  \label{fig:level0}
 \end{minipage}
 \begin{minipage}[t]{0.16\hsize}
  \center
  \includegraphics[width=1in, height=1in, keepaspectratio]{./img/preparation/orbit/level0invc.pdf}
  \subcaption{}
   \label{fig:level0inv}
 \end{minipage}
 \begin{minipage}[t]{0.16\hsize}
  \center
  \includegraphics[width=1in, height=1in, keepaspectratio]{./img/preparation/orbit/level1c.pdf}
  \subcaption{}
   \label{fig:level1}
 \end{minipage}
 \begin{minipage}[t]{0.16\hsize}
  \center
  \includegraphics[width=1in, height=1in,
  keepaspectratio]{./img/preparation/orbit/level1invc.pdf}
  \subcaption{}
  \label{fig:level1inv}
 \end{minipage}
 \begin{minipage}[t]{0.16\hsize}
  \center
  \includegraphics[width=1in, height=1in, keepaspectratio]{./img/preparation/orbit/level2c.pdf}
  \subcaption{}
  \label{fig:level2}
 \end{minipage}
 \begin{minipage}[t]{0.16\hsize}
  \center
  \includegraphics[width=1in, height=1in, keepaspectratio]{img/preparation/orbit/levelMaxc.pdf}
  \subcaption{}
  \label{fig:levelMax}
 \end{minipage}
 \caption{\textit{The process of rendering the orbit of Schottky disks}}
\end{figure}

\noindent To solve the problems we discussed in previous section,
we focus circle inversions and invent an efficient algorithm to
visualize \textit{circle inversion fractals} shown in Figure \ref{fig:levelMax}.

The algorithm is called \textit{Iterated Inversion System (IIS.)}
It can visualize not only two dimensional circle inversion fractals but
also three dimensional sphere inversion fractals.

The fractal in Figure \ref{fig:levelMax} shows the orbit of the first
four circles.
It is also Kleinian group composed of four circle inversions.
The process of generation of circle inversion fractals is
as follows.

\begin{enumerate}
 \item We need some disjoint disks to obtain circle inversion fractals.
       For example, we assume there are four orange disks as shown in
       Figure \ref{fig:level0}. We call orange disks \textit{initial
       disks} and their boundary \textit{initial circles}.
 \item First of all, we focus on the white circle in Figure
       \ref{fig:level0inv}. The inversion in the white circle moves the
       other three disks into the interior of the white circle.
 \item After we apply each inversion in the initial circle to the outer disks,
       we obtain twelve small disks. They are shown in Figure \ref{fig:level1}.
 \item Next, we invert the twelve small disks in the initial circles.
       The inversion in the white circle moves the outer nine small disks
       into the interior of the white circle as shown in Figure \ref{fig:level1inv}.
       Each inversion in the Schottky circle generates smaller disks, and we
       obtain Figure \ref{fig:level2}.
 \item We continue iterating these process, that is, we continue
       applying each inversion in the initial circle to resulting
       smaller disks.
       Finally, we get Figure \ref{fig:levelMax}.
\end{enumerate}

\subsubsection{Two Dimensional IIS}

\begin{figure}[htbp]
  \center
  \includegraphics[height=1.35in, keepaspectratio]{img/preparation/orbIIS.png}
  \caption{\textit{Orbit of blue point by IIS}}
  \label{fig:iisOrbit}
 \hspace*{\fill}
\end{figure}

IIS computes the depth of the circles point by point.
Thus, we can use parallel processing.
The images in this paper are rendered using \textit{OpenGL Shading
Language (GLSL)}.
For two dimensional fractals, the algorithm of IIS is as follows.

\noindent IIS is applied to each point on the plane and computes nesting depth of
the disk which contains the point.
The process of the algorithm is as follows.
First of all, if the point is contained in initial disks, we invert the
point in the boundary circle of the disk.
We continue applying inversions until the transformed point is in the
out side of the initial circles.
Figure \ref{fig:iisOrbit} shows orbit of the blue point transformed by
iterations of inversions.

Furthermore, a point actually at the limit set never reaches the
outside. So, we have to determine the maximum number of iterations in
advance to prevent the algorithm from running indeÔ¨Ånitely.
However, the points except for the limit set are guaranteed that they
are transformed to outside because inversions are involution.

 \begin{algorithm}
  \caption{Iterated Inversion System (IIS)}
  \label{arg:iis2d}
  \begin{algorithmic}
   \REQUIRE count $= 0$ and coordinates $=$ position determined by
   pixel
   \FOR{$i=0$ to MAX\_INVERSION}
   \STATE inOutside $\leftarrow$ \TRUE
   \FOR{ each inversion $I$ in circles }
   \IF{The circle $I$ contains coordinates}
   \STATE coordinates $\leftarrow$ $I(\text{coordinates})$
   \STATE INCREMENT count
   \STATE inOutside $\leftarrow$ \FALSE
   \ENDIF
   \ENDFOR
   \IF {inOutside}
   \STATE BREAK for
   \ENDIF
   \ENDFOR
   \STATE RETURN count
  \end{algorithmic}
 \end{algorithm}

\noindent Pseudo-code is in Algorithm \ref{arg:iis2d}.

\subsubsection{Three Dimensional Extension}

In the similar manner to two dimensional algorithm,
we extend the IIS to visualize three-dimensional kleinian groups.
We extend circle inversion to sphere inversion easily, and we
compute the nesting depth of the sphere voxel by voxel.

We use \textit{ray tracing} to visualize three dimensional objects.
Ray tracing computes intersection between ray and objects algebraically.
There are two ways to render nesting spheres. First one is drawing
transparent spheres. Second one is \textit{volume rendering}.
However, it is difficult to render them efficiently, and
visualized images are not interesting.

Therefor we render the orbit of sphere in a similar way to the two
dimensional circle inversion fractals.
Thus, we prepare seed spheres of the orbit, and transform elements of
the group.

\begin{figure}[htbp]
 \begin{minipage}[t]{0.5\hsize}
  \center
  \includegraphics[height=1.35in, keepaspectratio]{img/preparation/3dExtension/3dKissingGenerator.png}
  \caption{\textit{Generator}}
  \label{fig:cayleyGraph}
  \hspace*{\fill}
 \end{minipage}
 \begin{minipage}[t]{0.5\hsize}
  \center
  \includegraphics[height=1.35in, keepaspectratio]{img/preparation/3dExtension/3dOrbit.png}
  \caption{\textit{The orbit of the green sphere}}
  \label{fig:orbitCat}
  \hspace*{\fill}
 \end{minipage}
\end{figure}

We use \textit{Sphere Tracing} \cite{hart1996sphere} to render three dimensional
fractals and orbit of the seed sphere.
Sphere Tracing is one of the algorithm to ray tracing.

%% „Åì„ÅÆ„Ç¢„É´„Ç¥„É™„Ç∫„É†„ÅØË∑ùÈõ¢Èñ¢Êï∞„ÇíÁî®„ÅÑ„Å¶Áâ©‰Ωì„ÇíÊèèÁîª„Åô„ÇãÔºéÁâ©‰Ωì„ÅÆËªåÈÅì„ÇíSphere
%% Tracing„ÅßÊèèÁîª„Åô„ÇãÈöõ„Å´„ÅØÔºåÁâ©‰Ωì„ÅÆ„É§„Ç≥„Éì„Ç¢„É≥„Å´Ê≥®ÁõÆ„Åô„ÇãÔºé
%% ‰æã„Åà„Å∞ÔºåÁâ©‰Ωì„ÅÆÊã°Á∏Æ„ÅÆËªåÈÅì„ÇíSphereTracing„ÅßÊèè„Åè„Åü„ÇÅ„Å´„ÅØ
%% Êã°Á∏Æ„ÅÆ„É§„Ç≥„Éì„Ç¢„É≥„ÅØÔºåy = ax„ÅÆ„Å®„Åça„Åß„ÅÇ„ÇãÔºéÊúÄÁµÇÁöÑ„Å´„É§„Ç≥„Éì„Ç¢„É≥a„ÅßË∑ùÈõ¢„Çí
%% Ââ≤„Çã„Åì„Å®„ÅßÂÆüÈöõ„ÅÆË∑ùÈõ¢„ÇíÂæó„ÇãÔºé


\subsection{Related Works}

Aaron Montag uses texture based approach to visualize limit set of the
Kleinian groups \cite{Montag2014hyperbolicIFS}.
%% „ÉÜ„ÇØ„Çπ„ÉÅ„É£„Éô„Éº„Çπ„ÅÆÊèèÁîªÊñπÊ≥ï „ÉÜ„ÇØ„Çπ„ÉÅ„É£„Å´Á®Æ„Å®„Å™„ÇãÂÜÜ„ÇíÊèè„ÅçÔºåÂÜÜ„Å´Â§âÊèõ„Çí‰Ωú
%% Áî®„Åï„Åõ„Çã„Åì„Å®„ÅßÊ•µÈôêÈõÜÂêà„ÇíÊèèÁîª„Åï„Åõ„Çã

Jos Leys invented efficient algorithm to draw Kleinian group with Maskit
parametrization. IIS uses circle inversions on the other hand Jos Leys
uses normal generators.
%% IIS„ÇíÊôÆÈÄö„ÅÆÈñ¢Êï∞„Çí‰Ωø„Å£„Å¶Ë°å„Å£„Å¶„ÅÑ„Çã „Åì„Å°„Çâ„ÅÆIIS„ÅØÂÜÜÔºåÁêÉ„Å´Ê≥®ÁõÆ„Åó„Å¶„ÅÑ„Çã

Martin von Gagern introduce similar algorithm called \textit{Reverse
Pixel Lookup} \cite{journals/combinatorics/GagernR09}. The algorithm is for visualizing tiling.